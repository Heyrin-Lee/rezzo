<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
<style>
body {
   background: #eee
}

#container {
   width : 98%;
   margin : 0 auto;
}

.col {
   width: 700px
}

.c_btn {
   color: #fff;
   font-size: 13px;
   background: #333;
   border: none;
   padding: 6px;
   border-radius: 4px
}

.c_btn:hover {
   background: #555;
}

.linelist {
   float: right;
   margin: 0 20px 20px 0;
   
}



</style>
</head>
<body>
<!-- 본문내용 -->
<th:block layout:fragment="main">  
 <!-- 헤더부분 -->
   <div class="container-fluid px-4">
      <h1 class="mt-4">생산지시</h1>
      <ol class="breadcrumb mb-4">
         <li class="breadcrumb-item active">생산</li>
      </ol>
   </div>
   <!-- 헤더부분 -->
   <div id="container">
 	
     <div class="linelist">
       <button class="c_btn" form="">초기화</button>
       <input type="button" data-bs-toggle="modal" class="c_btn" id="modalBtn" data-bs-target="#exampleModal"
                    value="주문서조회"></input>
       <button class="c_btn" form="">저장</button>
     </div>
     
	 <div id="grid"></div>
	 <br>
	  <div class="d-flex flex-row justify-content-between">
	     <div id="grid2" style="width: 1000px;">공정자재</div>
	     <div id="grid3" style="width: 500px;">자재지시</div>
	  </div>
	  
	  
	  <div id="dialog" title="생산계획조회"></div>
   <br>
 </div>	
    <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">생산계획조회</h5>
                        <br> <br>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div><br>
                    <div id="modGrid" class="modal-body"></div>
                    <div class="modal-footer">
                        <button type="button" id="confirmBtn" class="btn btn-primary"
                            data-bs-dismiss="modal">확인</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    </div>
                </div>
            </div>
        </div>
   <script>
   //미진행 생산계획 띄우기
   	$("#modalBtn").on("click", function() {
   		$.ajax({
   			url : 'planListModal',
   			method : 'GET',
   			dataType: "JSON",
   			success: function (result) {
   				modGrid.resetData(result);
   			}
   		})
   	})
   	
   	//메인그리드에 모달 내용 띄우기
   	 $("#confirmBtn").on("click", function(e){
        	let result = modGrid.getCheckedRows();
        	console.log(result)
        	grid.resetData(result);
     })
   	
   	
   	
   	 const modGrid = new tui.Grid({
                el: document.getElementById('modGrid'),
                scrollX: false,
                scrollY: false,
                rowHeaders: ['checkbox'],
                columns: [{
                    header: '생산계획코드',
                    name: 'planCd',
                    align: 'center',
                }, {
                    header: '제품명',
                    name: 'prdtNm',
                    align: 'center'
                }, {
                    header: '주문수량',
                    name: 'orderCnt',
                    align: 'center',
                }]
            })
   	
   
   const gridData = [];
  
   const grid = new tui.Grid({
	      el: document.getElementById('grid'),
	      data: gridData,
	      scrollX: false,
	      scrollY: false,
	      columns: [
	        {
	          header: '제품코드',
	          name: 'edctsCd'
	        },
	        {
	          header: '제품명',
	          name: 'prdtNm'
	        },
	        {
	          header: '계획번호',
	          name: 'planCd'
	        },
	        {
		      header: '납기일자',
		      name: 'paprdDt'
		    },
	        {
	          header: '라인코드',
	          name: 'lineCd'
	        },
	        {
	          header: '담당자',
	          name: 'prcsPsch',
	          editor : 'text'
	        },
	        {
	          header: '필요수량',
	          name: 'orderCnt'
	        },
	        {
	          header: '지시수량',
	          name: 'indicaCnt'
	        },
	        {
	          header: '작업지시일',
	          name: 'indicaDt',
	          editor : 'datePicker'
	        }
	      ]
	    });
   
   const gridData2 = [];
      
   const grid2 = new tui.Grid({
	      el: document.getElementById('grid2'),
	      data: gridData2,
	      scrollX: false,
	      scrollY: false,
	      columns: [
	        {
	          header: '공정코드',
	          name: 'c1'
	        },
	        {
	          header: '자재코드',
	          name: 'c2'
	        },
	        {
	          header: 'LOT번호',
	          name: 'c3'
	        },
	        {
	          header: '사용수량',
	          name: 'c4',
	        },
	        {
	          header: '재고수량',
	          name: 'c5',
	        },
	        {
	          header: '사용량',
	          name: 'c6'
	        }
	      ]
	    });
   
   const gridData3 = [];
  
   const grid3 = new tui.Grid({
	      el: document.getElementById('grid3'),
	      data: gridData2,
	      scrollX: false,
	      scrollY: false,
	      columns: [
	        {
	          header: '공정코드',
	          name: 'c1'
	        },
	        {
	          header: 'LOT번호',
	          name: 'c3'
	        },
	        {
	          header: '사용수량',
	          name: 'c4'
	        }
	      ]
	    });
	    
	modalBtn.addEventListener('click', function () {
                setTimeout(function () {
                    modGrid.refreshLayout()
                }, 300);
            });    
	


   </script>
</th:block>
</body>
</html>