<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rezzo.mes.prod.plan.mapper.PlanMapper">

<select id="orderListModal" resultType="com.rezzo.mes.prod.plan.service.PlanVO">
	SELECT *
	FROM ORDER_SHEET
</select>

<select id="getIndex" resultType="int">
	SELECT NVL(MAX(SUBSTR(PLAN_CD, 12)), 0) 
	FROM PLAN
	WHERE PLAN_DT = #{planDt}
</select>
 
<select id="getPrcsFlow" resultType="PlanVO" >
	SELECT EDCTS_CD, PRCS_CD 
	FROM PRCS_FLOW 
	WHERE EDCTS_CD = #{edctsCd}
</select>

<select id="getRscInfo" resultType="com.rezzo.mes.prod.plan.service.PlanVO">
	SELECT DISTINCT I.RSC_CD, I.RSC_LOT_NO, O.RSC_CNT, B.USE_CNT, B.EDCTS_CD, B.PRCS_CD
	FROM RSC_IST I 
	JOIN RSC_ORDR_DTL O
	ON I.RSC_CD = O.RSC_CD
	JOIN BOM B
	ON B.RSC_CD = I.RSC_CD
	WHERE EDCTS_CD=#{edctsCd}
</select> 

<insert id="grid1Insert" parameterType="PlanVO">
	insert into plan (plan_cd,
					  paprd_Dt,	
					  now_st,
					  plan_dt,
					  order_no	
						)
	values (#{planCd},
			#{paprdDt},
			'미진행',
			#{planDt},
			#{orderNo}
			)
</insert>
 
<insert id="grid2Insert" parameterType="PlanVO">
	insert into plan_dtl 
	values (#{planDt},
			#{lineCd},
			#{edctsCd},
			#{orderCnt},
			#{indicaCnt},
			#{planCd},
			#{wkToDt},
			#{wkFrDt},
			#{prefRank}
			)
</insert>

<insert id="grid5Insert" parameterType="PlanVO">
	insert into holding
	values (
			#{planCd},
			#{rscCd},
			#{rscUse},
			#{rscLotNo}
			)
</insert>


</mapper>